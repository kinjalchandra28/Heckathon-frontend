<aside class="flex flex-col h-screen w-64 bg-white border-r border-gray-200 p-4">
  <!-- Logo -->
  <div class="mb-6">
    <img src="assets/icons/logo.svg" class="h-10" alt="Logo" />
  </div>

  <!-- Main Nav -->
  <nav class="space-y-1">
    @for (item of navItems; track item.label) {
      <a
        [routerLink]="item.route"
        routerLinkActive="bg-gray-100 font-medium"
        class="flex items-center gap-3 px-3 py-2 rounded-lg text-gray-700 hover:bg-gray-50 cursor-pointer"
      >
        <img [src]="item.icon" class="w-5 h-5" [alt]="item.label" />
        <span>{{ item.label }}</span>
      </a>
    }
  </nav>

  <!-- Agents Section -->
  <!-- <div class="mt-6">
    <button
      (click)="agentsExpanded = !agentsExpanded"
      class="flex items-center gap-1 text-sm font-medium text-gray-900 mb-2"
    >
      Agents
      <svg
        class="w-4 h-4 transition-transform"
        [class.rotate-180]="!agentsExpanded"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
      >
        <path d="M6 9l6 6 6-6" />
      </svg>
    </button>
    @if (agentsExpanded) {
      <div class="space-y-1 pl-2">
        @for (agent of agents; track agent) {
          <a class="block px-3 py-1.5 text-sm text-gray-600 hover:bg-gray-50 rounded cursor-pointer">
            {{ agent }}
          </a>
        }
      </div>
    }
  </div> -->

  <!-- Chats Section -->
  <div class="mt-6 flex-1 overflow-hidden">
    <span class="text-sm font-medium text-gray-900">Chats</span>
    <div class="mt-2 space-y-1 overflow-y-auto max-h-48">
      @if (chatsLoading) {
        <div class="px-3 py-2 text-sm text-gray-400">Loading chats...</div>
      } @else if (chats.length === 0) {
        <div class="px-3 py-2 text-sm text-gray-400">No chats yet</div>
      } @else {
        @for (chat of chats; track chat.chatId) {
          <a
            (click)="openChat(chat)"
            class="block px-3 py-1.5 text-sm text-gray-600 hover:bg-gray-50 rounded cursor-pointer truncate"
            [title]="chat.csvFileName || chat.title || 'Chat'"
          >
            {{ chat.chatId || chat.title || 'Untitled Chat' }}
          </a>
        }
      }
    </div>
    <a routerLink="/search-chats" class="block mt-2 text-sm text-gray-500 hover:text-gray-700 cursor-pointer">View all chats</a>
  </div>

  <!-- User Profile -->
  <div class="mt-auto pt-4 border-t border-gray-200">
    @if (user$ | async; as user) {
      <div class="flex items-center justify-between">
        <div class="flex items-center gap-3">
          <div class="w-8 h-8 rounded-full bg-blue-100 flex items-center justify-center">
            <span class="text-sm font-medium text-blue-600">
              {{ user.name ? user.name.charAt(0).toUpperCase() : user.email.charAt(0).toUpperCase() }}
            </span>
          </div>
          <div class="flex flex-col">
            <span class="text-sm text-gray-700 truncate max-w-[120px]">{{
              user.name || 'User'
            }}</span>
            <span class="text-xs text-gray-400 truncate max-w-[120px]">{{ user.email }}</span>
          </div>
        </div>
        <button
          (click)="logout()"
          class="p-2 hover:bg-gray-100 rounded-lg text-gray-400 hover:text-gray-600"
          title="Sign out"
        >
          <svg
            class="w-5 h-5"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
          >
            <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4" />
            <polyline points="16 17 21 12 16 7" />
            <line x1="21" y1="12" x2="9" y2="12" />
          </svg>
        </button>
      </div>
    }
  </div>
</aside>
